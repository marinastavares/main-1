import renderer from 'react-test-renderer';
import { renderToString } from 'fela-tools';
import felaTestContext from './felaTestContext';
import createRenderer from './createRenderer';
import cssbeautify from 'cssbeautify';

const options = {
  indent: '  ',
  openbrace: 'end-of-line',
  autosemicolon: false
};

export default component => {
  const felaRenderer = createRenderer({
    dev: true
  });

  return {
    component: renderer
      .create(felaTestContext(component, felaRenderer))
      .toJSON(),
    styles: `\n${cssbeautify(renderToString(felaRenderer), options)}\n`
  };
};
