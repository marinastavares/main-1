"use strict";

var _utilEnGarde = require("@cloudflare/util-en-garde");

var ZoneRulesetRewriteRuleValue = _utilEnGarde.eg.object({
  uri: _utilEnGarde.eg.object({
    path: _utilEnGarde.eg.object({
      value: _utilEnGarde.eg.string.optional,
      expression: _utilEnGarde.eg.string.optional
    }).optional,
    query: _utilEnGarde.eg.object({
      value: _utilEnGarde.eg.string.optional,
      expression: _utilEnGarde.eg.string.optional
    }).optional
  })
});

var ZoneRulesetHeaderModificationRuleValue = _utilEnGarde.eg.object({
  headers: _utilEnGarde.eg.record(_utilEnGarde.eg.string, _utilEnGarde.eg.object({
    operation: _utilEnGarde.eg.union([_utilEnGarde.eg.literal('add'), _utilEnGarde.eg.literal('set'), _utilEnGarde.eg.literal('remove')]),
    expression: _utilEnGarde.eg.string.optional,
    value: _utilEnGarde.eg.string.optional
  }))
});

var ZoneRulesetSanitizeRuleValue = _utilEnGarde.eg.object({
  id: _utilEnGarde.eg.string,
  overrides: _utilEnGarde.eg.object({
    rules: _utilEnGarde.eg.array(_utilEnGarde.eg.object({
      id: _utilEnGarde.eg.string,
      enabled: _utilEnGarde.eg.boolean
    }))
  })
});

var ZoneRulesetRewriteRule = _utilEnGarde.eg.object({
  id: _utilEnGarde.eg.string,
  version: _utilEnGarde.eg.string,
  action: _utilEnGarde.eg.literal('rewrite'),
  expression: _utilEnGarde.eg.string,
  description: _utilEnGarde.eg.string,
  last_updated: _utilEnGarde.eg.string,
  action_parameters: _utilEnGarde.eg.union([ZoneRulesetRewriteRuleValue, ZoneRulesetHeaderModificationRuleValue, ZoneRulesetSanitizeRuleValue]),
  ref: _utilEnGarde.eg.string.optional,
  enabled: _utilEnGarde.eg.boolean
});

var Ruleset = _utilEnGarde.eg.object({
  id: _utilEnGarde.eg.string,
  name: _utilEnGarde.eg.string,
  kind: _utilEnGarde.eg.union([_utilEnGarde.eg.literal('zone'), _utilEnGarde.eg.literal('managed')]),
  version: _utilEnGarde.eg.string,
  last_updated: _utilEnGarde.eg.string,
  phase: _utilEnGarde.eg.union([_utilEnGarde.eg.literal('http_request_transform'), _utilEnGarde.eg.literal('http_request_late_transform'), _utilEnGarde.eg.literal('http_request_sanitize')]),
  rules: _utilEnGarde.eg.array(ZoneRulesetRewriteRule).optional
});

var RulesMigration = _utilEnGarde.eg.object({
  firewall_rules_ui_enabled: _utilEnGarde.eg.boolean,
  custom_rules_ui_enabled: _utilEnGarde.eg.boolean
});