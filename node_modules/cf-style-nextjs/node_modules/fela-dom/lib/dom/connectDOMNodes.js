'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = connectDOMNodes;

var _felaUtils = require('fela-utils');

var _initDOMNode = require('./initDOMNode');

var _initDOMNode2 = _interopRequireDefault(_initDOMNode);

var _findDOMNodes = require('./findDOMNodes');

var _findDOMNodes2 = _interopRequireDefault(_findDOMNodes);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var sheetMap = {
  fontFaces: _felaUtils.FONT_TYPE,
  statics: _felaUtils.STATIC_TYPE,
  keyframes: _felaUtils.KEYFRAME_TYPE,
  rules: _felaUtils.RULE_TYPE
};
function connectDOMNodes(renderer) {
  renderer.nodes = (0, _findDOMNodes2.default)();

  var cacheCluster = (0, _felaUtils.clusterCache)(renderer.cache, renderer.mediaQueryOrder);

  var baseNode = renderer.nodes[_felaUtils.RULE_TYPE];

  (0, _felaUtils.objectEach)(sheetMap, function (type, key) {
    if (cacheCluster[key].length > 0) {
      (0, _initDOMNode2.default)(renderer.nodes, baseNode, cacheCluster[key], type);
    }
  });

  (0, _felaUtils.objectEach)(cacheCluster.mediaRules, function (clusteredCache, media) {
    if (clusteredCache.length > 0) {
      (0, _initDOMNode2.default)(renderer.nodes, baseNode, clusteredCache, _felaUtils.RULE_TYPE, media);
    }
  });
}